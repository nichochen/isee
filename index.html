<html>
    <head>
        
        <title>Homemade Visual Dictionary for Kids</title>
        
        <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js'></script>

        <style>
            body{
                background-color:lavender;
            }

            .word_mouse_down{
                color:crimson;
            }

            .word_mouse_up{
                color:black;
            }    

            .header {
                background:#BBA5E1;
                color: white;
                position:absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 5em;
                text-align: center;
            }

            .footer {
                position: fixed;
                left: 0;
                bottom: 0;
                width: 100%;
                margin-top: 10px;
                margin-bottom: 10px;
                margin-left: 5em;
                text-align: center;
                font-size: 8;
                color: rgb(196, 192, 228);
            }

            a:link {
                color: rgb(196, 192, 228);
                text-decoration: none;
            }

            a:visited {
                color: rgb(196, 192, 228);
                text-decoration: none;
            }

        </style>
        <script>

            var p_map_cam = {
                'the':'/media/english/us_pron/t/the/the_0/the_01_00.mp3',
                'of':'/media/english/us_pron/e/eus/eus75/eus75163.mp3',
                'a':'/media/english/us_pron/a/a_0/a_01_/a_01_00.mp3',
                'you':'/media/english/us_pron/u/u__/u____/u.mp3',
                'on':'/media/english/us_pron/e/eus/eus73/eus73326.mp3',
                'I':'',
                'be':'/media/english/us_pron/b/b__/b____/b.mp3',
                'one':'/media/english/us_pron/e/eus/eus75/eus75023.mp3',
                'or':'/media/english/us_pron/e/eus/eus75/eus75267.mp3',
                'by':'/media/english/us_pron/b/buy/buy__/buy.mp3',
                'out':'/media/english/us_pron/e/eus/eus75/eus75457.mp3',
                'other':'/media/english/us_pron/e/eus/eus75/eus75322.mp3',
                'there':'/media/english/us_pron/t/the/their/their.mp3',
                'use':'/media/english/us_pron/c/cal/cald4/cald4us2374.mp3',
                'time':'/media/english/us_pron/t/thy/thyme/thyme.mp3',
                'write':'/media/english/us_pron/r/rig/right/right.mp3',
                'would':'/media/english/us_pron/w/woo/wood_/wood.mp3',
                'so':'/media/english/us_pron/s/sew/sew__/sew.mp3',
                'see':'/media/english/us_pron/c/c__/c____/c.mp3',
                'two':'/media/english/us_pron/t/to_/to___/to.mp3',
                'no':'/media/english/us_pron/e/eus/eus73/eus73226.mp3',
                'know':'/media/english/us_pron/e/eus/eus73/eus73226.mp3',
                'than':'/media/english/us_pron/e/eus/eus74/eus74533.mp3',
                'may':'/media/english/us_pron/e/eus/eus72/eus72942.mp3',
                'been':'/media/english/us_pron/b/bea/bean_/bean.mp3',
                'new':'/media/english/us_pron/k/kne/knew_/knew.mp3',
                'live':'/media/english/us_pron/l/liv/live_/live_01_00.mp3',
                'only':'/media/english/us_pron/e/eus/eus75/eus75217.mp3',
                'round':'/media/english/us_pron/u/ukr/ukrou/ukrough006.mp3',
                'man':'/media/english/us_pron/e/eus/eus72/eus72888.mp3',
                'our':'/media/english/us_pron/h/hou/hour_/hour.mp3',
                'through':'/media/english/us_pron/t/thr/threw/threw.mp3',
                'sentence':'/media/english/us_pron/e/eus/eus74/eus74155.mp3',
                'great':'/media/english/us_pron/g/gra/grate/grate.mp3',
                'old':'/media/english/us_pron/e/eus/eus75/eus75193.mp3',
                'too':'/media/english/us_pron/t/to_/to___/to.mp3',
                'add':'/media/english/us_pron/a/ad_/ad___/ad.mp3',
                'here':'/media/english/us_pron/h/hea/hear_/hear.mp3',
                'high':'/media/english/us_pron/h/hi_/hi___/hi.mp3',
                'off':'/media/english/us_pron/e/eus/eus75/eus75164.mp3',
                'need':'/media/english/us_pron/k/kne/knead/knead.mp3',
                'us':'/media/english/us_pron/u/us_/us_02/us_02_00.mp3',
                'father':'/media/english/us_pron/c/cdo/cdo03/cdo0318usfath1774.mp3',
                'own':'/media/english/us_pron/e/eus/eus75/eus75455.mp3',
                'page':'/media/english/us_pron/e/eus/eus73/eus73394.mp3',
                'sun':'/media/english/us_pron/s/son/son__/son.mp3',
                'four':'/media/english/us_pron/f/for/for__/for.mp3',
                'eye':'/media/english/us_pron/a/aye/aye__/aye.mp3',
                'sea':'/media/english/us_pron/c/c__/c____/c.mp3',
                'draw':'/media/english/us_pron/e/eus/eus71/eus71388.mp3',
                'close':'/media/english/us_pron/e/eus/eus70/eus70844.mp3',
                'night':'/media/english/us_pron/k/kni/knigh/knight.mp3',
                'open':'/media/english/us_pron/e/eus/eus75/eus75227.mp3',
                'seem':'/media/english/us_pron/s/sea/seam_/seam.mp3',
                'children':'/media/english/us_pron/c/chi/child/children_child.mp3',
                'often':'/media/english/us_pron/e/eus/eus75/eus75181.mp3',
                'until':'/media/english/us_pron/e/eus/eus74/eus74757.mp3',
                'feet':'/media/english/us_pron/f/fea/feat_/feat.mp3',
                'began':'/media/english/us_pron/b/beg/began/began_begin.mp3',
                'once':'/media/english/us_pron/e/eus/eus75/eus75209.mp3',
                'horse':'/media/english/us_pron/h/hoa/hoars/hoarse.mp3',
                'sure':'/media/english/us_pron/s/sho/shore/shore.mp3',
                'main':'/media/english/us_pron/e/eus/eus72/eus72872.mp3',
                'red':'/media/english/us_pron/r/rea/read_/read_read.mp3',
                'direct':'/media/english/us_pron/e/eus/eus75/eus75604.mp3',
                'wind':'/media/english/us_pron/e/eus/eus74/eus74998.mp3',
                'order':'/media/english/us_pron/e/eus/eus75/eus75280.mp3',
                'piece':'/media/english/us_pron/p/pea/peace/peace.mp3',
                'whole':'/media/english/us_pron/h/hol/hole_/hole.mp3',
                'heard':'',
                'toward':'/media/english/us_pron/e/eus/eus74/eus74594.mp3',
                'war':'/media/english/us_pron/w/wor/wore_/wore.mp3',
                'pattern':'/media/english/us_pron/e/eus/eus73/eus73455.mp3',
                'center':'/media/english/us_pron/e/eus/eus70/eus70754.mp3',
                'certain':'/media/english/us_pron/e/eus/eus70/eus70760.mp3',
                'lead':'/media/english/us_pron/l/lea/lead_/lead_01_00.mp3',
                'week':'/media/english/us_pron/w/wea/weak_/weak.mp3',
                'oh':'/media/english/us_pron/e/eus/eus75/eus75076.mp3',
                'ocean':'/media/english/us_pron/e/eus/eus75/eus75146.mp3',
                'minute':'/media/english/us_pron/e/eus/eus73/eus73026.mp3',
                'produce':'/media/english/us_pron/p/pro/produ/produce_01_00.mp3',
                'multiply':'/media/english/us_pron/e/eus/eus73/eus73129.mp3',
                'course':'/media/english/us_pron/c/coa/coars/coarse.mp3',
                'blue':'/media/english/us_pron/b/ble/blew_/blew.mp3',
                'object':'/media/english/us_pron/e/eus/eus75/eus75092.mp3',
                'decide':'/media/english/us_pron/e/eus/eus75/eus75521.mp3',
                'record':'/media/english/us_pron/r/rec/recor/record_01_00.mp3',
                'plane':'/media/english/us_pron/p/pla/plain/plain.mp3',
                'stead':'/media/english/us_pron/u/uss/ussta/usstarg029.mp3',
                'paint':'/media/english/us_pron/e/eus/eus73/eus73396.mp3',
                'wave':'/media/english/us_pron/w/wai/waive/waive.mp3',
                'am':'/media/english/us_pron/a/am_/am_be/am_be.mp3',
                'present':'/media/english/us_pron/p/pre/prese/present_01_00.mp3',
                'engine':'/media/english/us_pron/e/eus/eus75/eus75693.mp3',
                'material':'/media/english/us_pron/u/usc/uscld/uscld00868.mp3',
                'weight':'/media/english/us_pron/w/wai/wait_/wait.mp3',
                'matter':'/media/english/us_pron/e/eus/eus72/eus72937.mp3',
                'divide':'/media/english/us_pron/e/eus/eus71/eus71342.mp3',
                'lone':'/media/english/us_pron/l/loa/loan_/loan.mp3',
                'exercise':'/media/english/us_pron/e/eus/eus71/eus71699.mp3',
                'winter':'/media/english/us_pron/e/eus/eus75/eus75004.mp3',
                'sat':'/media/english/us_pron/s/sat/sat_0/sat_02_00.mp3',
                'kept':'/media/english/us_pron/k/kep/kept_/kept_keep.mp3',
                'bear':'/media/english/us_pron/b/bar/bare_/bare.mp3',
                'gone':'/media/english/us_pron/e/eus/eus72/eus72057.mp3',
                'meet':'/media/english/us_pron/m/mea/meat_/meat.mp3',
                'metal':'/media/english/us_pron/e/eus/eus72/eus72975.mp3',
                'roll':'/media/english/us_pron/r/rol/role_/role.mp3',
                'observe':'/media/english/us_pron/e/eus/eus75/eus75120.mp3',
                'organ':'/media/english/us_pron/e/eus/eus75/eus75287.mp3',
                'experiment':'/media/english/us_pron/e/eus/eus71/eus71710.mp3',
                'twenty':'/media/english/us_pron/e/eus/eus74/eus74663.mp3',
                'office':'/media/english/us_pron/e/eus/eus75/eus75172.mp3',
                'row':'/media/english/us_pron/r/roe/roe__/roe.mp3',
                'symbol':'/media/english/us_pron/c/cym/cymba/cymbal.mp3',
                'wrote':'/media/english/us_pron/r/rot/rote_/rote.mp3',
                'seed':'/media/english/us_pron/c/ced/cede_/cede.mp3',
                'break':'/media/english/us_pron/b/bra/brake/brake.mp3',
                'oil':'/media/english/us_pron/u/uso/usoff/usoffse010.mp3',
                'cost':'/media/english/us_pron/e/eus/eus71/eus71027.mp3',
                'lost':'/media/english/us_pron/l/los/lost_/lost_lose.mp3',
                'wear':'/media/english/us_pron/e/eus/eus74/eus74948.mp3',
                'sent':'/media/english/us_pron/c/cen/cent_/cent.mp3',
                'difficult':'/media/english/us_pron/e/eus/eus75/eus75602.mp3',
                'period':'/media/english/us_pron/e/eus/eus73/eus73504.mp3',
                'atom':'/media/english/us_pron/e/eus/eus70/eus70360.mp3',
                'effect':'/media/english/us_pron/e/eus/eus71/eus71442.mp3',
                'electric':'/media/english/us_pron/e/eus/eus71/eus71469.mp3',
                'party':'/media/english/us_pron/e/eus/eus73/eus73438.mp3',
                'operate':'/media/english/us_pron/e/eus/eus75/eus75231.mp3',
                'sight':'/media/english/us_pron/c/cit/cite_/cite.mp3',
                'desert':'/media/english/us_pron/d/des/deser/desert_03_00.mp3',
                'current':'/media/english/us_pron/c/cur/curra/currant.mp3',
                'block':'/media/english/us_pron/b/blo/bloc_/bloc.mp3',
                'event':'/media/english/us_pron/e/eus/eus71/eus71680.mp3',
                'opposite':'/media/english/us_pron/e/eus/eus75/eus75246.mp3',
                'property':'/media/english/us_pron/e/eus/eus73/eus73744.mp3',
                'molecule':'/media/english/us_pron/e/eus/eus75/eus75835.mp3',
                'gray':'/media/english/us_pron/c/cdo/cdo03/cdo0318usgray2134.mp3',
                'nose':'/media/english/us_pron/n/noe/noes_/noes.mp3',
                'continent':'/media/english/us_pron/e/eus/eus70/eus70988.mp3',
                'oxygen':'/media/english/us_pron/e/eus/eus75/eus75461.mp3',
                'pretty':'/media/english/us_pron/e/eus/eus73/eus73704.mp3',
                'women':'/media/english/us_pron/c/cdo/cdo03/cdo0318uswome5635.mp3',
                'steel':'/media/english/us_pron/s/ste/steal/steal.mp3',
                'led':'/media/english/us_pron/l/lea/lead_/lead_08_00.mp3',
                'nor':'/media/english/us_pron/u/usz/uszzz/uszzzzd078.mp3',
                'favor':'/media/english/us_pron/c/cdo/cdo03/cdo0318usfavo1780.mp3',
                'original':'/media/english/us_pron/e/eus/eus75/eus75297.mp3',
                'offer':'/media/english/us_pron/e/eus/eus75/eus75171.mp3',
                'degree':'/media/english/us_pron/e/eus/eus75/eus75549.mp3',
                'populate':'/media/english/us_pron/u/usp/uspom/uspompo017.mp3',
                'occur':'/media/english/us_pron/e/eus/eus75/eus75144.mp3',
                'azure' :'/media/english/us_pron/u/usa/usavo/usavowa020.mp3',
                'orange' : '/media/english/us_pron/e/eus/eus75/eus75268.mp3',
                'bee' : '/media/english/us_pron/b/b__/b____/b.mp3'
            };

            function get_pronunciation_url_ox(word, accent){
                var url = 'https://ssl.gstatic.com/dictionary/static/sounds/oxford/' + word.toLowerCase() + '--_' + accent + '_1.mp3';
                return url;
            }

            function get_pronunciation_url_cam(word){

                //fomalize input
                word = word.toLowerCase();

                //generate the path for input
                if ( p_map_cam[word] == undefined){
                    i3 = [];
                    i5 = [];

                    for(var i = 0; i < 3; i++){
                        i3[i] = ( i > word.length -1 ? '_' : word[i]);
                    }

                    for(var i = 0; i < 5; i++){
                        i5[i] = ( i > word.length -1 ? '_' : word[i]);
                    }

                    prefix = '/media/english/us_pron/';
                    surfix = '.mp3';
                    
                    path = prefix + word[0] + '/' + i3.join('') + '/' + i5.join('') + '/' + word  + surfix;

                }else{
                    console.log(p_map_cam[word])
                    path = p_map_cam[word];
                }

                var url = 'https://dictionary.cambridge.org/' + path;
                return url;
            }

            function pronounce(word){
                    var url = get_pronunciation_url_cam(word, 'us');
                    audio = new Audio(url);
                    audio.play();
            }

            function search(input){
                $('#iframe_image').attr('src', 'https://cn.bing.com/images/search?q=' + encodeURI(input) + '&go=Search&qs=ds&form=QBIR');
            }

            function word_click(s){          
                var word = $('#' + s.id).text()
                pronounce(word);
                search(word);
            }

            function tapping_click(s){          
                $('#word0').click();
                $('#word0').mousedown()
            }

            $(document).ready(function(){

                $('#ta_input').on('input',function(){
                    $('#output_words').empty();
                    var words = $('#ta_input').val();
                    words_arr = words.split(' ');
                    $('#output_words').append('<span><img onclick="tapping_click();" style="top: 30px; position:relative" src="images/tapping.png" width="100"></span>')
                    for(var i=0; i<words_arr.length; i++){
                        $('#output_words').append(`<span onclick="word_click(this);" id="word${i}" >${words_arr[i]}</span><span> </span>`);   
                    }

                    $('span[id^="word"]').mousedown(function(s){
                        $('span[id^="word"]').attr('class', 'word_mouse_up');
                        $('#' + s.target.id).attr('class', 'word_mouse_down')
                    });
                });

                //too lazy to select the text manually
                $('#ta_input').mouseover(function(){
                    $('#ta_input').select();

                });

                //serach the input with bing
                $('#search').click(function(){
                    var words = $('#ta_input').val();
                    if(words != ''){
                        search(words);
                    }
                });

                $('#btn_close').click(function(){
                    $('#ta_input').val('');
                    $('#ta_input').focus();
                    $('#output_words').empty();
                });
            
                //Init
                $('#output_words').text($('#ta_input').val());

                let h = $(window).height();
                let w = $(window).width();      
                r = h/w;

                
                $('#iframe_image').height(r > 1 ? h * 0.4 : h * 0.6);
                $('#iframe_image').width(r > 1 ? w/2 : w);
                $('#iframe_image').css('top', r > 1 ? -15 : -70);
                $('#iframe_image').css('left', r > 1 ? w/4 : 0);
                $('#iframe_image').css('-webkit-transform', r > 1 ? 'scale(2)' : 'scale(1)');
                $('#ta_input').css('font-size', r > 1 ?'4em':'2em');
                $('#ta_input').attr('cols', r > 1 ?'14':'40');
                $('#btn_close').width(r > 1 ? 100 : 40);
                $('#search').width(r > 1 ? 100 : 40);
                $('#spacer').height(($('#iframe_image').height()) * (r > 1 ? 2 : 1) - (r > 1 ? 300 : 80));
    });
        </script>
    </head>
    <body>
        <center>
            <div style="display:table-cell; overflow:hidden; height="600" width"600"> 
                <iframe id="iframe_image" name="search" src="help.html" scrolling="no"  allowfullscreen="" style="-webkit-transform:scale(1);border-width: 0;left:0;position:absolute; min-height: 260px; width: 100%"></iframe>
           </div>

            <div class="header">
                <a href="help.html" target="search">
                    <img src="images/logo.png" style="padding: 10px; height: 4em;">
                </a>
            </div>
            
            <div id="spacer"></div>

            <div id='output_words' style='font-size: 100px;margin: 5px;'></div>
            <br>
            <span width="80%" style="background-color: #BBA5E1; margin-left:20px; padding:20px; border-radius: 20px; max-width: 800px;display:table-cell ; ">
                <div style="display: table-cell; vertical-align: middle; ">
                        <img id="btn_close" src="images/close.png" width="40" style="margin-right:10px;">
                </div>
                <div style="border-radius: 10px; max-width: 800px; overflow: hidden;display: table-cell;">
                    <textarea id='ta_input' rows="1"" cols="20" style='padding: 10px; border-color:plum;border-width: 0px;' autocapitalize="none"></textarea>
                </div>
                <div style="display: table-cell;vertical-align: middle;margin-left:10px;">
                    <img  id="search" src="images/search.png" width="50" style="margin-left: 10px;">
                </div>
            </span>
            <br>
            <div class="footer">
                <b>Homemade Visual Dictionary for Kids|Based on <a href="https://www.bing.com/">Bing</a> and <a href="https://dictionary.cambridge.org/">Cambridge Dictionary</a></b>
            </div>  
        </center>
    </body>
</html>

